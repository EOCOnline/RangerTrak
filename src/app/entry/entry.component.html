<div class="container">
  <form #frm="ngForm" [formGroup]="entryDetailsForm" (ngSubmit)="onFormSubmit(frm.value)" class="enter__form">

    <!--div id="enter__frm-reguritation">
      <pre>{{ frm.value |json}}</pre>
    </div-->

    <h1>Entry Form</h1>
    <h2 class="elegant">Who</h2>

    <!--  https://material.angular.io/components/autocomplete/examples#autocomplete-overview -->
    <mat-form-field class="enter__Callsign" appearance="fill">
      <mat-label>CallSign</mat-label>

      <input matInput [formControl]="callsignCtrl" type="text" placeholder="Pick one" aria-label="Callsigns"
        formControlName="callsign" [matAutocomplete]="auto" (change)="this.CallsignCtrlChanged()" id="enter__Callsign-input">

      <mat-autocomplete #auto="matAutocomplete">
        <mat-option *ngFor="let ranger of filteredRangers | async" [value]="ranger.callsign">
          <!--img class="enter__Callsign-img" aria-hidden [src]="ranger.image" height="40"-->
          <span>{{ranger.callsign}}</span> |
          <small> {{ranger.licensee}} | {{ranger.phone}}</small>
        </mat-option>
      </mat-autocomplete>

    </mat-form-field>
    <span id="enter__Callsign-upshot"></span>

    <!-- br>ToDo: [Future: Maybe only enter Team OR Callsign. If team, then ALL TeamMembers get checked in all at once???]  >
    <div #div1 class="input-group">Team:
      <input [class.border-danger]="entryDetailsForm.get('team')?.touched && entryDetailsForm.get('team')?.invalid"
        type="text" formControlName="team" placeholder="Team">
      <div *ngIf="entryDetailsForm.get('team')?.touched && entryDetailsForm.get('team')?.hasError('required')"
        class="text-sm text-danger">Team is required</div>
    </div -->


    <div id="enter__SmallMap">

      <google-map id="map" width="100%" [center]="center" [zoom]="zoom" [options]="options"
        (mapMousemove)="onMapMouseMove($event)" (mapInitialized)="onMapInitialized($event)"
        style="width: 300px; height:300px;">
      </google-map>

      <!-- https://angular.io/api/common/DecimalPipe#digitsinfo -->
      <div>Latitude: <span class="strong">{{display?.lat | number:'1.4-5'}}</span> Longitude: <span
          class="strong">{{display?.lng | number:'1.4-5'}}</span>
      </div>
    </div>
    <br>


    <h2 class="elegant">Where</h2>

    <div class="input-group">&nbsp;&nbsp;&nbsp;Latitude:
      <input
      [class.border-danger]="entryDetailsForm.get('latI')?.touched && entryDetailsForm.get('latI')?.invalid"
      type="number" formControlName="latI" placeholder="LatitudeI" (change)="this.addressCtrlChanged('latI')"
      name="latitudeDDI" id="latitudeDDI"  size="4" min="-180" max="180" id="enter__LatI">

      <span *ngIf="entryDetailsForm.get('latI')?.touched && entryDetailsForm.get('latI')?.hasError('required')"
        class="text-sm text-danger">lat is required
      </span>° <span title="Decimal Degrees">DD</span> or&nbsp;


      <input
        [class.border-danger]="entryDetailsForm.get('latD')?.touched && entryDetailsForm.get('latD')?.invalid"
        type="number" formControlName="latD" placeholder="LatitudeD" (change)="this.addressCtrlChanged('latD')"
        name="latitudeDDD" id="latitudeDDD" step="0.001" size="8" min="0" max="99999" id="enter__LatD">

        <!--onchange="DDCoordsChanged()"
      {{lat | number:'1.4-5'}}
      {{entryDetailsForm.get(lat) | number:'1.4-5'}}
        -->
      <span *ngIf="entryDetailsForm.get('latD')?.touched && entryDetailsForm.get('latD')?.hasError('required')"
        class="text-sm text-danger">lat is required
      </span>° <span title="Decimal Degrees">DD</span> or&nbsp;


      <input name="latitudeQ" id="latitudeQ" type="text" value="N" size="1" pattern="'e','E','w','W'" title="E or W"
        onchange="DMSCoordsChanged()"> <!-- Quadrant -->
      <input name="latitudeD" id="latitudeD" type="text" value="47" size="2" min="0" max="180"
        onchange="DMSCoordsChanged()">°
      <!-- TODO: Use settings.DefLat -->
      <input name="latitudeM" id="latitudeM" type="text" value="" size="2" min="0" max="59"
        onchange="DMSCoordsChanged()">'
      <input name="latitudeS" id="latitudeS" type="text" value="" size="5" min="0" max="59.99"
        onchange="DMSCoordsChanged()">"&nbsp;<span title="Degrees Minute Seconds">DMS</span>
    </div>


    <div class="input-group">
      Longitude:
      <input [class.border-danger]="entryDetailsForm.get('long')?.touched && entryDetailsForm.get('long')?.invalid"
        type="number" formControlName="long" placeholder="Longitude" (change)="this.addressCtrlChanged('lng')"
        name="longitudeDD" id="longitudeDD" step="0.001" size="12" min="-180" max="180" id="enter__Long">
      <!-- onchange="DDCoordsChanged()" -->
      <span *ngIf="entryDetailsForm.get('long')?.touched && entryDetailsForm.get('long')?.hasError('required')"
        class="text-sm text-danger">long is required
      </span>° <span title="Decimal Degrees">DD</span> or&nbsp;

      <input name="longitudeQ" id="longitudeQ" type="text" value="W" size="1" pattern="'n','N','s','S'" title="N or S"
        onchange="DMSCoordsChanged()">
      <input name="longitudeD" id="longitudeD" type="text" value="122" size="2" max="180"
        onchange="DMSCoordsChanged()">°
      <input name="longitudeM" id="longitudeM" type="text" value="" size="2" min="0" max="59"
        onchange="DMSCoordsChanged()">'
      <input name="longitudeS" id="longitudeS" type="text" value="" size="5" min="0" max="59.99"
        onchange="DMSCoordsChanged()">"
      <span title="Degrees Minute Seconds">DMS</span>
    </div>

    Street Address, +Code, or What.3.Words:
    <input [class.border-danger]="entryDetailsForm.get('address')?.touched && entryDetailsForm.get('address')?.invalid"
      type="text" formControlName="address"  id="addressCtrl"
      title="Enter www.Plus.Codes, www.What3Words.com, or streeet address for geocoding." size="40"
      placeholder="Address" (change)="this.addressCtrlChanged('addr')"> (optional)

    <!-- formControlName="addressCtrl"

      input name="addresses" id="addresses" type="text" size="15" value=""
      placeholder="" title="Enter www.Plus.Codes, www.What3Words.com, or streeet address for geocoding."
      onchange="chkAddresses()"> (optional) -->
    <!-- placeholder="84VVCGWP+VW" title ="Enter short or full PlusCode" placeholder="pil.tutles.binde"-->
    <br>
    <span id="addressLabel" value="">addressLabel</span>&nbsp;&nbsp;
    <span id="pCodeGlobal">pCodeGlobal</span>
    <br>

    <!--div
    *ngIf="entryDetailsForm.get('address')?.touched && entryDetailsForm.get('address')?.hasError('required')"
    class="text-sm text-danger">address is required</div  -->
    <!--/div-->
    <br>


    <!--br-->

    <!--div class="input-group"><span class="strongish">Derived Addresses:</span>
      <div id="top3wa">&nbsp;&nbsp;&nbsp;Top 3 word address match: </div>
      <div id="coords">&nbsp;&nbsp;&nbsp;WGS84 Coordinates: </div>
      <div id="nearest_place">&nbsp;&nbsp;&nbsp;Nearest Place: </div>
      <div>&nbsp;&nbsp;&nbsp;Derived Address: <span id="derivedAddress" #derivedAddress>WA locale; Full code: +Code:
          8VCWVF22+</span>
      </div>

      <!- -script type="module"
        src="https://cdn.what3words.com/javascript-components@4-latest/dist/what3words/what3words.esm.js"></script>
      <script nomodule
        src="https://cdn.what3words.com/javascript-components@4-latest/dist/what3words/what3words.js?key=YOUR-API-KEY"></script- ->

      <!- -form id="form" method="GET"- ->
      <div id="what3words-autosuggest">
        <!- -what3words-autosuggest- ->
        &nbsp;&nbsp;&nbsp;what3words-autosuggest: <input type="text" />
        <!- -/what3words-autosuggest- ->
      </div>
      <!- -/form- ->
    </div-->


    <h2 class="elegant">When</h2>
    <!-- TODO: Use Time Picker: https://material.io/components/time-pickers#usage
          showSpinners: If true, the spinners above and below input are visible
          showSeconds: If true, it is not possible to select seconds
          disableMinute: If true, the minute is readonly
          defaultTime: An array [hour, minute, second] for default time when the date is not yet defined
         >

    <ngx-mat-timepicker [(ngModel)]="myTimePicker">
        </ngx-mat-timepicker-->

    <div class="input-group">Date:
      <input [class.border-danger]="entryDetailsForm.get('date')?.touched && entryDetailsForm.get('date')?.invalid"
        type="datetime" formControlName="date" placeholder="date" id="enter_When-input">
      <div *ngIf="entryDetailsForm.get('date')?.touched && entryDetailsForm.get('date')?.hasError('required')"
        class="text-sm text-danger">date is required</div>
    </div>

    <h2 class="elegant bordered">What</h2>

    <div class="input-group bordered" id="bordered">Status:
      <mat-radio-group labelPosition="after" formControlName="status"
        [class.border-danger]="entryDetailsForm.get('status')?.touched && entryDetailsForm.get('status')?.invalid">
        <mat-radio-button *ngFor="let stat of fieldReportStatuses" value={{stat}}>{{stat}} &nbsp;&nbsp;&nbsp;
        </mat-radio-button>
      </mat-radio-group>

      <div *ngIf="entryDetailsForm.get('status')?.touched && entryDetailsForm.get('status')?.hasError('required')"
        class="text-sm text-danger">Status is required</div>
      <br><br>
      <textarea class="input-group enter__What--area" formControlName="note" id="enter__What--area" cols="80" rows="5"
        placeholder="Enter Any Notes"></textarea>
    </div>


    <!-- TODO: Add h4> Keywords</h4>
    <div formArrayName="keywords">
      <div *ngIf="keywordsControls && keywordsControls.length">
        <div *ngFor="let keywordControl of keywordsControls; let i = index">
          <div class="input-group">
            <input [class.border-danger]="keywordControl.touched && keywordControl.invalid" [formControlName]="i"
              type="text" placeholder="keyword" />
            <div *ngIf="keywordControl.touched && keywordControl.hasError('required')" class="text-sm text-danger">
              keyword Name is required</div>
          </div>
          <hr>
        </div>
      </div>
    </div-->
    <br><br>

    <br>
    <br>
    <!--button (click)="onBtnUpdateLocation()">Update location</button> <br-->
    <!--button (click)="this.entryDetailsForm.reset()" type="reset">Reset (native)</button> <br-->
    <button (click)="resetForm()" title="Reset all form fields to their defaults" class="eButton"
      type="button">Reset</button>
    <button [disabled]="entryDetailsForm.invalid" class="enter__Submit-button eButton" type="submit">Submit</button>

    <span id="enter__Submit-info"></span>

  </form>
</div>

<!--
<fieldset>
      <legend>Where</legend>
      Street Address, +Code, or What3Words (optional): <input name="addresses" id="addresses" type="text" size="15"
        value="" placeholder="" title="Enter www.Plus.Codes, www.What3Words.com, or streeet address for geocoding."
        onchange="chkAddresses()">
      <placeholder="84VVCGWP+VW" title ="Enter short or full PlusCode" placeholder="pil.tutles.binde">
      <span id="addressLabel" value=""></span>
      <span id="pCodeGlobal"></span>
      <br>
      Latitude: &nbsp;&nbsp;
      <input name="latitudeQ" id="latitudeQ" type="text" value="N" size="1" pattern="'e','E','w','W'" title="E or W"
        onchange="DMSCoordsChanged()"> <!- Quadrant ->
      <input name="latitudeD" id="latitudeD" type="text" value="47" size="2" min="0" max="180" onchange="DMSCoordsChanged()">°
      <input name="latitudeM" id="latitudeM" type="text" value="" size="2" min="0" max="59" onchange="DMSCoordsChanged()">'
      <input name="latitudeS" id="latitudeS" type="text" value="" size="5" min="0" max="59.99" onchange="DMSCoordsChanged()">"
      &nbsp;&nbsp; or &nbsp;&nbsp;<input name="latitudeDD" id="latitudeDD" type="text" size="7" min="-180" max="180"
        onchange="DDCoordsChanged()">°
      <br>
      Longitude:
      <input name="longitudeQ" id="longitudeQ" type="text" value="W" size="1" pattern="'n','N','s','S'" title="N or S"
        onchange="DMSCoordsChanged()">
      <input name="longitudeD" id="longitudeD" type="text" value="122" size="2" max="180" onchange="DMSCoordsChanged()">°
      <input name="longitudeM" id="longitudeM" type="text" value="" size="2" min="0" max="59" onchange="DMSCoordsChanged()">'
      <input name="longitudeS" id="longitudeS" type="text" value="" size="5" min="0" max="59.99"
        onchange="DMSCoordsChanged()">"
      &nbsp;&nbsp; or &nbsp;&nbsp;<input name="longitudeDD" id="longitudeDD" type="text" size="7" min="-180" max="180"
        onchange="DDCoordsChanged()">°
      <br>
    </fieldset>
-->



<!--
<mat-form-field>
  <input matInput [ngxMatDatetimePicker]="picker" placeholder="Choose a date & time" [(ngModel)]="myDatePicker">

  <ngx-mat-timepicker [(ngModel)]="myTimePicker">
  </ngx-mat-timepicker>

  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>

  <ngx-mat-datetime-picker #picker></ngx-mat-datetime-picker>
</mat-form-field>

<  IF Max & Min time desired:
<mat-form-field>
<input matInput [ngxMatDatetimePicker]="pickerFrom" placeholder="From date & time" [(ngModel)]="myDatePickerFrom">

<mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>

<ngx-mat-datetime-picker #pickerFrom [enableMeridian]="true"></ngx-mat-datetime-picker>
</mat-form-field>

<mat-form-field>
<input matInput [ngxMatDatetimePicker]="pickerTo" placeholder="To date & time" [(ngModel)]="myDatePickerTo"
[min]="myDatePickerFrom">

<mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>

<ngx-mat-datetime-picker #pickerTo [enableMeridian]="true"></ngx-mat-datetime-picker>
</mat-form-field>

-->
