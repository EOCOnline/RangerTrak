<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>rangertrak documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
        <link rel="stylesheet" href="../styles/Vagrant.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">rangertrak documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Classes</li>
  <li >CodeArea</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/shared/mapping/open-location-code.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Coordinates of a decoded Open Location Code.</p>
<p>The coordinates include the latitude and longitude of the lower left and
upper right corners and the center of the bounding box for the area the
code represents.</p>

            </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#codeLength" >codeLength</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#latitudeCenter" >latitudeCenter</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#latitudeHi" >latitudeHi</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#latitudeLo" >latitudeLo</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#longitudeCenter" >longitudeCenter</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#longitudeHi" >longitudeHi</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#longitudeLo" >longitudeLo</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getLatitudeHeight" >getLatitudeHeight</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getLongitudeWidth" >getLongitudeWidth</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(latitudeLo: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, longitudeLo: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, latitudeHi: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, longitudeHi: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, codeLength: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:32</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>latitudeLo</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>longitudeLo</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>latitudeHi</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>longitudeHi</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>codeLength</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="codeLength"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>codeLength</b></span>
                        <a href="#codeLength"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="latitudeCenter"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>latitudeCenter</b></span>
                        <a href="#latitudeCenter"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:28</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>The latitude of the center in degrees.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="latitudeHi"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>latitudeHi</b></span>
                        <a href="#latitudeHi"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="latitudeLo"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>latitudeLo</b></span>
                        <a href="#latitudeLo"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="longitudeCenter"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>longitudeCenter</b></span>
                        <a href="#longitudeCenter"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:32</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>The longitude of the center in degrees.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="longitudeHi"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>longitudeHi</b></span>
                        <a href="#longitudeHi"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="longitudeLo"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>longitudeLo</b></span>
                        <a href="#longitudeLo"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/app/shared/mapping/open-location-code.ts:34</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getLatitudeHeight"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>getLatitudeHeight</b></span>
                        <a href="#getLatitudeHeight"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getLatitudeHeight()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="39"
                            class="link-to-prism">src/app/shared/mapping/open-location-code.ts:39</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getLongitudeWidth"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>getLongitudeWidth</b></span>
                        <a href="#getLongitudeWidth"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getLongitudeWidth()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="43"
                            class="link-to-prism">src/app/shared/mapping/open-location-code.ts:43</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">const LATITUDE_MAX &#x3D; 90;
const LONGITUDE_MAX &#x3D; 180;

/**
 * Coordinates of a decoded Open Location Code.
 *
 * The coordinates include the latitude and longitude of the lower left and
 * upper right corners and the center of the bounding box for the area the
 * code represents.
 *
 * @constructor
 */
export class CodeArea {
  /**
   * The latitude of the center in degrees.
   */
  public latitudeCenter: number;
  /**
   * The longitude of the center in degrees.
   */
  public longitudeCenter: number;

  constructor(public latitudeLo:number, public longitudeLo:number, public latitudeHi:number, public longitudeHi:number, public codeLength:number) {
    this.latitudeCenter &#x3D; Math.min(latitudeLo + (latitudeHi - latitudeLo) / 2, LATITUDE_MAX);
    this.longitudeCenter &#x3D; Math.min(longitudeLo + (longitudeHi - longitudeLo) / 2, LONGITUDE_MAX);
  }

  public getLatitudeHeight(): number {
    return this.latitudeHi - this.latitudeLo;
  }

  public getLongitudeWidth(): number {
    return this.longitudeHi - this.longitudeLo;
  }
}

/**
 * Open Location Code implementation for TypeScript
 */
export  class OpenLocationCode {   // TODO: default

  public constructor(public code: string) {
  }

  public getCode(): string {
    return this.code;
  }

  /**
   * Returns whether this {@link OpenLocationCode} is a padded Open Location Code, meaning that it
   * contains less than 8 valid digits.
   */
  public isPadded(): boolean {
    return this.code.indexOf(OpenLocationCode.PADDING_CHARACTER_) &gt;&#x3D; 0;
  }

  private static readonly CODE_PRECISION_NORMAL &#x3D; 10;
  private static readonly CODE_PRECISION_EXTRA &#x3D; 11;
  private static readonly MAX_DIGIT_COUNT_ &#x3D; 15;

  // A separator used to break the code into two parts to aid memorability.
  private static readonly SEPARATOR_ &#x3D; &quot;+&quot;;

  // The number of characters to place before the separator.
  private static readonly SEPARATOR_POSITION_ &#x3D; 8;

  // The character used to pad codes.
  private static readonly PADDING_CHARACTER_ &#x3D; &quot;0&quot;;

  // The character set used to encode the values.
  private static readonly CODE_ALPHABET_ &#x3D; &quot;23456789CFGHJMPQRVWX&quot;;

  // The base to use to convert numbers to/from.
  private static readonly ENCODING_BASE_ &#x3D; OpenLocationCode.CODE_ALPHABET_.length;

  // The maximum value for latitude in degrees.
  static readonly LATITUDE_MAX_ &#x3D; LATITUDE_MAX;

  // The maximum value for longitude in degrees.
  static readonly LONGITUDE_MAX_ &#x3D; LONGITUDE_MAX;

  // Maximum code length using lat/lng pair encoding. The area of such a
  // code is approximately 13x13 meters (at the equator), and should be suitable
  // for identifying buildings. This excludes prefix and separator characters.
  private static readonly PAIR_CODE_LENGTH_ &#x3D; 10;

  // The resolution values in degrees for each position in the lat/lng pair
  // encoding. These give the place value of each position, and therefore the
  // dimensions of the resulting area.
  private static readonly PAIR_RESOLUTIONS_ &#x3D; [20.0, 1.0, .05, .0025, .000125];

  // First place value of the pairs (if the last pair value is 1).
  private static readonly PAIR_FIRST_PLACE_VALUE_ &#x3D; Math.pow(OpenLocationCode.ENCODING_BASE_, (OpenLocationCode.PAIR_CODE_LENGTH_ / 2 - 1));

  // Inverse of the precision of the pair section of the code.
  private static readonly PAIR_PRECISION_ &#x3D; Math.pow(OpenLocationCode.ENCODING_BASE_, 3);

  // Number of digits in the grid precision part of the code.
  private static readonly GRID_CODE_LENGTH_ &#x3D; OpenLocationCode.MAX_DIGIT_COUNT_ - OpenLocationCode.PAIR_CODE_LENGTH_;

  // Number of columns in the grid refinement method.
  private static readonly GRID_COLUMNS_ &#x3D; 4;

  // Number of rows in the grid refinement method.
  private static readonly GRID_ROWS_ &#x3D; 5;

  // First place value of the latitude grid (if the last place is 1).
  private static readonly GRID_LAT_FIRST_PLACE_VALUE_ &#x3D; Math.pow(OpenLocationCode.GRID_ROWS_, (OpenLocationCode.GRID_CODE_LENGTH_ - 1));

  // First place value of the longitude grid (if the last place is 1).
  private static readonly GRID_LNG_FIRST_PLACE_VALUE_ &#x3D; Math.pow(OpenLocationCode.GRID_COLUMNS_, (OpenLocationCode.GRID_CODE_LENGTH_ - 1));

  // Multiply latitude by this much to make it a multiple of the finest
  // precision.
  private static readonly FINAL_LAT_PRECISION_ &#x3D; OpenLocationCode.PAIR_PRECISION_ *
      Math.pow(OpenLocationCode.GRID_ROWS_, (OpenLocationCode.MAX_DIGIT_COUNT_ - OpenLocationCode.PAIR_CODE_LENGTH_));

  // Multiply longitude by this much to make it a multiple of the finest
  // precision.
  private static readonly FINAL_LNG_PRECISION_ &#x3D; OpenLocationCode.PAIR_PRECISION_ *
      Math.pow(OpenLocationCode.GRID_COLUMNS_, (OpenLocationCode.MAX_DIGIT_COUNT_ - OpenLocationCode.PAIR_CODE_LENGTH_));

  // Minimum length of a code that can be shortened.
  private static readonly MIN_TRIMMABLE_CODE_LEN_ &#x3D; 6;


  /**
   * Determines if a code is valid.
   *
   * To be valid, all characters must be from the Open Location Code character
   * set with at most one separator. The separator can be in any even-numbered
   * position up to the eighth digit.
   *
   * @param {string} code The string to check.
   * @return {boolean} True if the string is a valid code.
   */
  public static isValid(code: string): boolean {
    if (!code) {
      return false;
    }
    // The separator is required.
    if (code.indexOf(OpenLocationCode.SEPARATOR_) &#x3D;&#x3D;&#x3D; -1) {
      return false;
    }
    if (code.indexOf(OpenLocationCode.SEPARATOR_) !&#x3D;&#x3D; code.lastIndexOf(OpenLocationCode.SEPARATOR_)) {
      return false;
    }
    // Is it the only character?
    if (code.length &#x3D;&#x3D;&#x3D; 1) {
      return false;
    }
    // Is it in an illegal position?
    if (code.indexOf(OpenLocationCode.SEPARATOR_) &gt; OpenLocationCode.SEPARATOR_POSITION_ ||
      code.indexOf(OpenLocationCode.SEPARATOR_) % 2 &#x3D;&#x3D;&#x3D; 1) {
      return false;
    }
    // We can have an even number of padding characters before the separator,
    // but then it must be the final character.
    if (code.indexOf(OpenLocationCode.PADDING_CHARACTER_) &gt; -1) {
      // Short codes cannot have padding
      if (code.indexOf(OpenLocationCode.SEPARATOR_) &lt; OpenLocationCode.SEPARATOR_POSITION_) {
        return false;
      }
      // Not allowed to start with them!
      if (code.indexOf(OpenLocationCode.PADDING_CHARACTER_) &#x3D;&#x3D;&#x3D; 0) {
        return false;
      }
      // There can only be one group and it must have even length.
      const padMatch &#x3D; code.match(new RegExp(&quot;(&quot; + OpenLocationCode.PADDING_CHARACTER_ + &quot;+)&quot;, &quot;g&quot;));
      if (!padMatch || padMatch.length &gt; 1 || padMatch[0].length % 2 &#x3D;&#x3D;&#x3D; 1 ||
        padMatch[0].length &gt; OpenLocationCode.SEPARATOR_POSITION_ - 2) {
        return false;
      }
      // If the code is long enough to end with a separator, make sure it does.
      if (code.charAt(code.length - 1) !&#x3D;&#x3D; OpenLocationCode.SEPARATOR_) {
        return false;
      }
    }
    // If there are characters after the separator, make sure there isn&#x27;t just
    // one of them (not legal).
    if (code.length - code.indexOf(OpenLocationCode.SEPARATOR_) - 1 &#x3D;&#x3D;&#x3D; 1) {
      return false;
    }

    // Strip the separator and any padding characters.
    const strippedCode &#x3D; code.replace(new RegExp(&quot;\\&quot; + OpenLocationCode.SEPARATOR_ + &quot;+&quot;), &quot;&quot;)
      .replace(new RegExp(OpenLocationCode.PADDING_CHARACTER_ + &quot;+&quot;), &quot;&quot;);
    // Check the code contains only valid characters.
    for (let i &#x3D; 0, len &#x3D; strippedCode.length; i &lt; len; i++) {
      const character &#x3D; strippedCode.charAt(i).toUpperCase();
      if (character !&#x3D;&#x3D; OpenLocationCode.SEPARATOR_ &amp;&amp; OpenLocationCode.CODE_ALPHABET_.indexOf(character) &#x3D;&#x3D;&#x3D; -1) {
        return false;
      }
    }
    return true;
  };

  /**
   * Returns whether the provided Open Location Code is a padded Open Location Code, meaning that it
   * contains less than 8 valid digits.
   */
  public static isPadded(code: string): boolean {
    return new OpenLocationCode(code).isPadded();
  }

  /**
   * Determines if a code is a valid short code.
   *
   * @param {string} code The string to check.
   * @return {boolean} True if the string can be produced by removing four or
   *     more characters from the start of a valid code.
   */
  public static isShort(code: string): boolean {
    if (!OpenLocationCode.isValid(code)) {
      return false;
    }
    // If there are less characters than expected before the SEPARATOR.
    return code.indexOf(OpenLocationCode.SEPARATOR_) &gt;&#x3D; 0 &amp;&amp; code.indexOf(OpenLocationCode.SEPARATOR_) &lt; OpenLocationCode.SEPARATOR_POSITION_;
  };

  /**
   * Determines if a code is a valid full Open Location Code.
   *
   * @param {string} code The string to check.
   * @return {boolean} True if the code represents a valid latitude and longitude combination.
   */
  public static isFull(code: string): boolean {
    if (!OpenLocationCode.isValid(code)) {
      return false;
    }
    // If it&#x27;s short, it&#x27;s not full.
    if (OpenLocationCode.isShort(code)) {
      return false;
    }

    // Work out what the first latitude character indicates for latitude.
    const firstLatValue &#x3D; OpenLocationCode.CODE_ALPHABET_.indexOf(code.charAt(0).toUpperCase()) * OpenLocationCode.ENCODING_BASE_;
    if (firstLatValue &gt;&#x3D; OpenLocationCode.LATITUDE_MAX_ * 2) {
      return false; // The code would decode to a latitude of &gt;&#x3D; 90 degrees.
    }
    if (code.length &gt; 1) {
      // Work out what the first longitude character indicates for longitude.
      const firstLngValue &#x3D; OpenLocationCode.CODE_ALPHABET_.indexOf(code.charAt(1).toUpperCase()) * OpenLocationCode.ENCODING_BASE_;
      if (firstLngValue &gt;&#x3D; OpenLocationCode.LONGITUDE_MAX_ * 2) {
        return false; // The code would decode to a longitude of &gt;&#x3D; 180 degrees.
      }
    }
    return true;
  };

  public contains(latitude: number, longitude: number): boolean {
    const codeArea &#x3D; OpenLocationCode.decode(this.getCode());
    return codeArea.latitudeLo &lt;&#x3D; latitude
      &amp;&amp; latitude &lt; codeArea.latitudeHi
      &amp;&amp; codeArea.longitudeLo &lt;&#x3D; longitude
      &amp;&amp; longitude &lt; codeArea.longitudeHi;
  }

  /**
   * Encode a location into an Open Location Code.
   *
   * @param {number} latitude The latitude in signed decimal degrees. It will
   *     be clipped to the range -90 to 90.
   * @param {number} longitude The longitude in signed decimal degrees. Will be
   *     normalised to the range -180 to 180.
   * @param {?number} codeLength The length of the code to generate. If
   *     omitted, the value OpenLocationCode.CODE_PRECISION_NORMAL will be used.
   *     For a more precise result, OpenLocationCode.CODE_PRECISION_EXTRA is
   *     recommended.
   * @return {string} The code.
   * @throws {Exception} if any of the input values are not numbers.
   */
  public static encode(latitude: number, longitude: number, codeLength: number &#x3D; OpenLocationCode.CODE_PRECISION_NORMAL): string {
    if (codeLength &lt; 2 || (codeLength &lt; OpenLocationCode.PAIR_CODE_LENGTH_ &amp;&amp; codeLength % 2 &#x3D;&#x3D;&#x3D; 1)) {
      throw new Error(&quot;IllegalArgumentException: Invalid Open Location Code length&quot;);
    }

    const editedCodeLength &#x3D; Math.min(OpenLocationCode.MAX_DIGIT_COUNT_, codeLength);

    // Ensure that latitude and longitude are valid.
    let editedLatitude &#x3D; OpenLocationCode.clipLatitude(latitude);
    const editedLongitude &#x3D; OpenLocationCode.normalizeLongitude(longitude);
    // Latitude 90 needs to be adjusted to be just less, so the returned code
    // can also be decoded.
    if (editedLatitude &#x3D;&#x3D;&#x3D; 90) {
      editedLatitude &#x3D; editedLatitude - OpenLocationCode.computeLatitudePrecision(editedCodeLength);
    }
    let code &#x3D; &#x27;&#x27;;

    // Compute the code.
    // This approach converts each value to an integer after multiplying it by
    // the final precision. This allows us to use only integer operations, so
    // avoiding any accumulation of floating point representation errors.

    // Multiply values by their precision and convert to positive.
    // Force to integers so the division operations will have integer results.
    // Note: JavaScript requires rounding before truncating to ensure precision!
    let latVal &#x3D;
        Math.floor(Math.round((editedLatitude + OpenLocationCode.LATITUDE_MAX_) * OpenLocationCode.FINAL_LAT_PRECISION_ * 1e6) / 1e6);
    let lngVal &#x3D;
        Math.floor(Math.round((editedLongitude + OpenLocationCode.LONGITUDE_MAX_) * OpenLocationCode.FINAL_LNG_PRECISION_ * 1e6) / 1e6);

    // Compute the grid part of the code if necessary.
    if (editedCodeLength &gt; OpenLocationCode.PAIR_CODE_LENGTH_) {
      for (let i &#x3D; 0; i &lt; OpenLocationCode.MAX_DIGIT_COUNT_ - OpenLocationCode.PAIR_CODE_LENGTH_; i++) {
        const latDigit &#x3D; latVal % OpenLocationCode.GRID_ROWS_;
        const lngDigit &#x3D; lngVal % OpenLocationCode.GRID_COLUMNS_;
        const ndx &#x3D; latDigit * OpenLocationCode.GRID_COLUMNS_ + lngDigit;
        code &#x3D; OpenLocationCode.CODE_ALPHABET_.charAt(ndx) + code;
        // Note! Integer division.
        latVal &#x3D; Math.floor(latVal / OpenLocationCode.GRID_ROWS_);
        lngVal &#x3D; Math.floor(lngVal / OpenLocationCode.GRID_COLUMNS_);
      }
    } else {
      latVal &#x3D; Math.floor(latVal / Math.pow(OpenLocationCode.GRID_ROWS_, OpenLocationCode.GRID_CODE_LENGTH_));
      lngVal &#x3D; Math.floor(lngVal / Math.pow(OpenLocationCode.GRID_COLUMNS_, OpenLocationCode.GRID_CODE_LENGTH_));
    }
    // Compute the pair section of the code.
    for (let i &#x3D; 0; i &lt; OpenLocationCode.PAIR_CODE_LENGTH_ / 2; i++) {
      code &#x3D; OpenLocationCode.CODE_ALPHABET_.charAt(lngVal % OpenLocationCode.ENCODING_BASE_) + code;
      code &#x3D; OpenLocationCode.CODE_ALPHABET_.charAt(latVal % OpenLocationCode.ENCODING_BASE_) + code;
      latVal &#x3D; Math.floor(latVal / OpenLocationCode.ENCODING_BASE_);
      lngVal &#x3D; Math.floor(lngVal / OpenLocationCode.ENCODING_BASE_);
    }

    // Add the separator character.
    code &#x3D; code.substring(0, OpenLocationCode.SEPARATOR_POSITION_) +
        OpenLocationCode.SEPARATOR_ +
        code.substring(OpenLocationCode.SEPARATOR_POSITION_);


    // If we don&#x27;t need to pad the code, return the requested section.
    if (editedCodeLength &gt;&#x3D; OpenLocationCode.SEPARATOR_POSITION_) {
      return code.substring(0, editedCodeLength + 1);
    }
    // Pad and return the code.
    return code.substring(0, editedCodeLength) +
        Array(OpenLocationCode.SEPARATOR_POSITION_ - editedCodeLength + 1).join(OpenLocationCode.PADDING_CHARACTER_) + OpenLocationCode.SEPARATOR_;
  };

  /**
   * Decodes an Open Location Code into its location coordinates.
   *
   * Returns a CodeArea object that includes the coordinates of the bounding
   * box - the lower left, center and upper right.
   *
   * @param {string} code The code to decode.
   * @return {CodeArea} An object with the coordinates of the
   *     area of the code.
   * @throws {Exception} If the code is not valid.
   */
  public static decode(code: string): CodeArea {
    // This calculates the values for the pair and grid section separately, using
    // integer arithmetic. Only at the final step are they converted to floating
    // point and combined.
    if (!OpenLocationCode.isFull(code)) {
      throw new Error(&quot;IllegalArgumentException: Passed Open Location Code is not a valid full code: &quot; + code);
    }
    // Strip the &#x27;+&#x27; and &#x27;0&#x27; characters from the code and convert to upper case.
    const editedCode &#x3D; code.replace(OpenLocationCode.SEPARATOR_, &#x27;&#x27;)
        .replace(new RegExp(OpenLocationCode.PADDING_CHARACTER_ + OpenLocationCode.SEPARATOR_), &#x27;&#x27;)
        .toUpperCase();

    // Initialise the values for each section. We work them out as integers and
    // convert them to floats at the end.
    let normalLat &#x3D; -OpenLocationCode.LATITUDE_MAX_ * OpenLocationCode.PAIR_PRECISION_;
    let normalLng &#x3D; -OpenLocationCode.LONGITUDE_MAX_ * OpenLocationCode.PAIR_PRECISION_;
    let gridLat &#x3D; 0;
    let gridLng &#x3D; 0;
    // How many digits do we have to process?
    let digits &#x3D; Math.min(editedCode.length, OpenLocationCode.PAIR_CODE_LENGTH_);
    // Define the place value for the most significant pair.
    let pv &#x3D; OpenLocationCode.PAIR_FIRST_PLACE_VALUE_;
    // Decode the paired digits.
    for (let position &#x3D; 0; position &lt; digits; position +&#x3D; 2) {
      normalLat +&#x3D; OpenLocationCode.CODE_ALPHABET_.indexOf(editedCode.charAt(position)) * pv;
      normalLng +&#x3D; OpenLocationCode.CODE_ALPHABET_.indexOf(editedCode.charAt(position + 1)) * pv;
      if (position &lt; digits - 2) {
        pv /&#x3D; OpenLocationCode.ENCODING_BASE_;
      }
    }
    // Convert the place value to a float in degrees.
    let latPrecision &#x3D; pv / OpenLocationCode.PAIR_PRECISION_;
    let lngPrecision &#x3D; pv / OpenLocationCode.PAIR_PRECISION_;
    // Process any extra precision digits.
    if (editedCode.length &gt; OpenLocationCode.PAIR_CODE_LENGTH_) {
      // Initialise the place values for the grid.
      let rowpv &#x3D; OpenLocationCode.GRID_LAT_FIRST_PLACE_VALUE_;
      let colpv &#x3D; OpenLocationCode.GRID_LNG_FIRST_PLACE_VALUE_;
      // How many digits do we have to process?
      digits &#x3D; Math.min(editedCode.length, OpenLocationCode.MAX_DIGIT_COUNT_);
      for (let i &#x3D; OpenLocationCode.PAIR_CODE_LENGTH_; i &lt; digits; i++) {
        const digitVal &#x3D; OpenLocationCode.CODE_ALPHABET_.indexOf(editedCode.charAt(i));
        const row &#x3D; Math.floor(digitVal / OpenLocationCode.GRID_COLUMNS_);
        const col &#x3D; digitVal % OpenLocationCode.GRID_COLUMNS_;
        gridLat +&#x3D; row * rowpv;
        gridLng +&#x3D; col * colpv;
        if (i &lt; digits - 1) {
          rowpv /&#x3D; OpenLocationCode.GRID_ROWS_;
          colpv /&#x3D; OpenLocationCode.GRID_COLUMNS_;
        }
      }
      // Adjust the precisions from the integer values to degrees.
      latPrecision &#x3D; rowpv / OpenLocationCode.FINAL_LAT_PRECISION_;
      lngPrecision &#x3D; colpv / OpenLocationCode.FINAL_LNG_PRECISION_;
    }
    // Merge the values from the normal and extra precision parts of the code.
    const lat &#x3D; normalLat / OpenLocationCode.PAIR_PRECISION_ + gridLat / OpenLocationCode.FINAL_LAT_PRECISION_;
    const lng &#x3D; normalLng / OpenLocationCode.PAIR_PRECISION_ + gridLng / OpenLocationCode.FINAL_LNG_PRECISION_;
    // Multiple values by 1e14, round and then divide. This reduces errors due
    // to floating point precision.
    return new CodeArea(
        Math.round(lat * 1e14) / 1e14, Math.round(lng * 1e14) / 1e14,
        Math.round((lat + latPrecision) * 1e14) / 1e14,
        Math.round((lng + lngPrecision) * 1e14) / 1e14,
        Math.min(editedCode.length, OpenLocationCode.MAX_DIGIT_COUNT_));
  };

  /**
   * Recover the nearest matching code to a specified location.
   *
   * Given a valid short Open Location Code this recovers the nearest matching
   * full code to the specified location.
   *
   * @param {string} shortCode A valid short code.
   * @param {number} latitude The latitude to use for the reference
   *     location.
   * @param {number} longitude The longitude to use for the reference
   *     location.
   * @return {string} The nearest matching full code to the reference location.
   * @throws {Exception} if the short code is not valid, or the reference
   *     position values are not numbers.
   */
  public static recoverNearest(shortCode: string, latitude: number, longitude: number): string {
    if (!OpenLocationCode.isShort(shortCode)) {
      if (OpenLocationCode.isFull(shortCode)) {
        return shortCode;
      } else {
        throw new Error(&quot;ValueError: Passed short code is not valid: &quot; + shortCode);
      }
    }

    const referenceLatitude &#x3D; OpenLocationCode.clipLatitude(latitude);
    const referenceLongitude &#x3D; OpenLocationCode.normalizeLongitude(longitude);
    const shortCodeUpper &#x3D; shortCode.toUpperCase(); // Clean up the passed code.
    // Compute the number of digits we need to recover.
    const paddingLength &#x3D; OpenLocationCode.SEPARATOR_POSITION_ - shortCodeUpper.indexOf(OpenLocationCode.SEPARATOR_);
    const resolution &#x3D; Math.pow(20, 2 - (paddingLength / 2)); // The resolution (height and width) of the padded area in degrees.
    const halfResolution &#x3D; resolution / 2.0; // Distance from the center to an edge (in degrees).

    // Use the reference location to pad the supplied short code and decode it.
    const codeArea &#x3D; OpenLocationCode.decode(OpenLocationCode.encode(referenceLatitude, referenceLongitude).substr(0, paddingLength) + shortCodeUpper);
    // How many degrees latitude is the code from the reference? If it is more
    // than half the resolution, we need to move it north or south but keep it
    // within -90 to 90 degrees.
    if (referenceLatitude + halfResolution &lt; codeArea.latitudeCenter &amp;&amp; codeArea.latitudeCenter - resolution &gt;&#x3D; -OpenLocationCode.LATITUDE_MAX_) {
      // If the proposed code is more than half a cell north of the reference location,
      // it&#x27;s too far, and the best match will be one cell south.
      codeArea.latitudeCenter -&#x3D; resolution;
    } else if (referenceLatitude - halfResolution &gt; codeArea.latitudeCenter &amp;&amp;
      codeArea.latitudeCenter + resolution &lt;&#x3D; OpenLocationCode.LATITUDE_MAX_) {
      // If the proposed code is more than half a cell south of the reference location,
      // it&#x27;s too far, and the best match will be one cell north.
      codeArea.latitudeCenter +&#x3D; resolution;
    }

    // How many degrees longitude is the code from the reference?
    if (referenceLongitude + halfResolution &lt; codeArea.longitudeCenter) {
      codeArea.longitudeCenter -&#x3D; resolution;
    } else if (referenceLongitude - halfResolution &gt; codeArea.longitudeCenter) {
      codeArea.longitudeCenter +&#x3D; resolution;
    }

    return OpenLocationCode.encode(codeArea.latitudeCenter, codeArea.longitudeCenter, codeArea.codeLength);
  };

  /**
   * Remove characters from the start of an OLC code.
   *
   * This uses a reference location to determine how many initial characters
   * can be removed from the OLC code. The number of characters that can be
   * removed depends on the distance between the code center and the reference
   * location.
   *
   * @param {string} code The full code to shorten.
   * @param {number} latitude The latitude to use for the reference location.
   * @param {number} longitude The longitude to use for the reference location.
   * @return {string} The code, shortened as much as possible that it is still
   *     the closest matching code to the reference location.
   * @throws {Exception} if the passed code is not a valid full code or the
   *     reference location values are not numbers.
   */
  public static shorten(code: string, latitude: number, longitude: number): string {
    if (!OpenLocationCode.isFull(code)) {
      throw new Error(&quot;ValueError: Passed code is not valid and full: &quot; + code);
    }
    if (code.indexOf(OpenLocationCode.PADDING_CHARACTER_) !&#x3D;&#x3D; -1) {
      throw new Error(&quot;ValueError: Cannot shorten padded codes: &quot; + code);
    }

    const codeUpper &#x3D; code.toUpperCase();
    const codeArea &#x3D; OpenLocationCode.decode(codeUpper);
    if (codeArea.codeLength &lt; OpenLocationCode.MIN_TRIMMABLE_CODE_LEN_) {
      throw new Error(&quot;ValueError: Code length must be at least &quot; + OpenLocationCode.MIN_TRIMMABLE_CODE_LEN_);
    }

    const latitudeClipped &#x3D; OpenLocationCode.clipLatitude(latitude);
    const longitudeClipped &#x3D; OpenLocationCode.normalizeLongitude(longitude);

    // How close are the latitude and longitude to the code center.
    const range &#x3D; Math.max(Math.abs(codeArea.latitudeCenter - latitudeClipped), Math.abs(codeArea.longitudeCenter - longitudeClipped));
    for (let i &#x3D; OpenLocationCode.PAIR_RESOLUTIONS_.length - 2; i &gt;&#x3D; 1; i--) {
      // Check if we&#x27;re close enough to shorten. The range must be less than 1/2
      // the resolution to shorten at all, and we want to allow some safety, so
      // use 0.3 instead of 0.5 as a multiplier.
      if (range &lt; (OpenLocationCode.PAIR_RESOLUTIONS_[i] * 0.3)) {
        // Trim it.
        return codeUpper.substring((i + 1) * 2);
      }
    }
    return codeUpper;
  };

  /**
   * Clip a latitude into the range -90 to 90.
   *
   * @param {number} latitude
   * @return {number} The latitude value clipped to be in the range.
   */
  private static clipLatitude(latitude: number): number {
    return Math.min(90, Math.max(-90, latitude));
  };

  /**
   * Compute the latitude precision value for a given code length.
   * Lengths &lt;&#x3D; 10 have the same precision for latitude and longitude, but
   * lengths &gt; 10 have different precisions due to the grid method having
   * fewer columns than rows.
   * @param {number} codeLength
   * @return {number} The latitude precision in degrees.
   */
  private static computeLatitudePrecision(codeLength: number): number {
    if (codeLength &lt;&#x3D; 10) {
      return Math.pow(20, Math.floor(codeLength / -2 + 2));
    }
    return Math.pow(20, -3) / Math.pow(OpenLocationCode.GRID_ROWS_, codeLength - 10);
  };

  /**
   * Normalize a longitude into the range -180 to 180, not including 180.
   *
   * @param {number} longitude
   * @return {number} Normalized into the range -180 to 180.
   */
  private static normalizeLongitude(longitude: number): number {
    let longitudeOutput &#x3D; longitude;
    while (longitudeOutput &lt; -180) {
      longitudeOutput &#x3D; longitudeOutput + 360;
    }
    while (longitudeOutput &gt;&#x3D; 180) {
      longitudeOutput &#x3D; longitudeOutput - 360;
    }
    return longitudeOutput;
  };
}
</code></pre>
    </div>
</div>









                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'CodeArea.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
